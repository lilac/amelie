<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!-- Created with Inkscape (http://www.inkscape.org/) -->

<svg
   xmlns:dc="http://purl.org/dc/elements/1.1/"
   xmlns:cc="http://creativecommons.org/ns#"
   xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
   xmlns:svg="http://www.w3.org/2000/svg"
   xmlns="http://www.w3.org/2000/svg"
   xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd"
   xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape"
   width="744.09448819"
   height="1052.3622047"
   id="svg2"
   version="1.1"
   inkscape:version="0.47 r22583">
  <defs
     id="defs4">
    <inkscape:perspective
       sodipodi:type="inkscape:persp3d"
       inkscape:vp_x="0 : 526.18109 : 1"
       inkscape:vp_y="0 : 1000 : 0"
       inkscape:vp_z="744.09448 : 526.18109 : 1"
       inkscape:persp3d-origin="372.04724 : 350.78739 : 1"
       id="perspective10" />
    <inkscape:perspective
       id="perspective3650"
       inkscape:persp3d-origin="0.5 : 0.33333333 : 1"
       inkscape:vp_z="1 : 0.5 : 1"
       inkscape:vp_y="0 : 1000 : 0"
       inkscape:vp_x="0 : 0.5 : 1"
       sodipodi:type="inkscape:persp3d" />
    <inkscape:perspective
       id="perspective3691"
       inkscape:persp3d-origin="0.5 : 0.33333333 : 1"
       inkscape:vp_z="1 : 0.5 : 1"
       inkscape:vp_y="0 : 1000 : 0"
       inkscape:vp_x="0 : 0.5 : 1"
       sodipodi:type="inkscape:persp3d" />
    <inkscape:perspective
       id="perspective3808"
       inkscape:persp3d-origin="0.5 : 0.33333333 : 1"
       inkscape:vp_z="1 : 0.5 : 1"
       inkscape:vp_y="0 : 1000 : 0"
       inkscape:vp_x="0 : 0.5 : 1"
       sodipodi:type="inkscape:persp3d" />
    <inkscape:perspective
       id="perspective3882"
       inkscape:persp3d-origin="0.5 : 0.33333333 : 1"
       inkscape:vp_z="1 : 0.5 : 1"
       inkscape:vp_y="0 : 1000 : 0"
       inkscape:vp_x="0 : 0.5 : 1"
       sodipodi:type="inkscape:persp3d" />
    <inkscape:perspective
       id="perspective3916"
       inkscape:persp3d-origin="0.5 : 0.33333333 : 1"
       inkscape:vp_z="1 : 0.5 : 1"
       inkscape:vp_y="0 : 1000 : 0"
       inkscape:vp_x="0 : 0.5 : 1"
       sodipodi:type="inkscape:persp3d" />
    <inkscape:perspective
       id="perspective4023"
       inkscape:persp3d-origin="0.5 : 0.33333333 : 1"
       inkscape:vp_z="1 : 0.5 : 1"
       inkscape:vp_y="0 : 1000 : 0"
       inkscape:vp_x="0 : 0.5 : 1"
       sodipodi:type="inkscape:persp3d" />
    <inkscape:perspective
       id="perspective4073"
       inkscape:persp3d-origin="0.5 : 0.33333333 : 1"
       inkscape:vp_z="1 : 0.5 : 1"
       inkscape:vp_y="0 : 1000 : 0"
       inkscape:vp_x="0 : 0.5 : 1"
       sodipodi:type="inkscape:persp3d" />
    <inkscape:perspective
       id="perspective4104"
       inkscape:persp3d-origin="0.5 : 0.33333333 : 1"
       inkscape:vp_z="1 : 0.5 : 1"
       inkscape:vp_y="0 : 1000 : 0"
       inkscape:vp_x="0 : 0.5 : 1"
       sodipodi:type="inkscape:persp3d" />
    <inkscape:perspective
       id="perspective4139"
       inkscape:persp3d-origin="0.5 : 0.33333333 : 1"
       inkscape:vp_z="1 : 0.5 : 1"
       inkscape:vp_y="0 : 1000 : 0"
       inkscape:vp_x="0 : 0.5 : 1"
       sodipodi:type="inkscape:persp3d" />
    <inkscape:perspective
       id="perspective4275"
       inkscape:persp3d-origin="0.5 : 0.33333333 : 1"
       inkscape:vp_z="1 : 0.5 : 1"
       inkscape:vp_y="0 : 1000 : 0"
       inkscape:vp_x="0 : 0.5 : 1"
       sodipodi:type="inkscape:persp3d" />
  </defs>
  <sodipodi:namedview
     id="base"
     pagecolor="#ffffff"
     bordercolor="#666666"
     borderopacity="1.0"
     inkscape:pageopacity="0.0"
     inkscape:pageshadow="2"
     inkscape:zoom="0.35"
     inkscape:cx="375"
     inkscape:cy="520"
     inkscape:document-units="px"
     inkscape:current-layer="layer1"
     showgrid="false"
     showguides="false"
     inkscape:guide-bbox="true"
     inkscape:snap-global="false">
    <sodipodi:guide
       orientation="0,1"
       position="236,1000"
       id="guide3622" />
    <sodipodi:guide
       orientation="1,0"
       position="12,1028"
       id="guide3626" />
    <sodipodi:guide
       orientation="0,1"
       position="186,1037"
       id="guide3628" />
  </sodipodi:namedview>
  <metadata
     id="metadata7">
    <rdf:RDF>
      <cc:Work
         rdf:about="">
        <dc:format>image/svg+xml</dc:format>
        <dc:type
           rdf:resource="http://purl.org/dc/dcmitype/StillImage" />
        <dc:title></dc:title>
      </cc:Work>
    </rdf:RDF>
  </metadata>
  <g
     inkscape:label="Layer 1"
     inkscape:groupmode="layer"
     id="layer1">
    <text
       xml:space="preserve"
       style="font-size:28.30376053px;font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;fill:#000000;fill-opacity:1;stroke:none;font-family:Georgia;-inkscape-font-specification:Andale Mono"
       x="292.24811"
       y="539.82367"
       id="text4153"><tspan
         sodipodi:role="line"
         id="tspan4155"
         x="292.24811"
         y="539.82367">Simple echo server (again 2)</tspan><tspan
         sodipodi:role="line"
         x="292.24811"
         y="575.20337"
         id="tspan4157"></tspan><tspan
         sodipodi:role="line"
         x="292.24811"
         y="610.58307"
         id="tspan4159" /></text>
    <text
       xml:space="preserve"
       style="font-size:16px;font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;fill:#000000;fill-opacity:1;stroke:none;font-family:DejaVu Sans Mono;-inkscape-font-specification:DejaVu Sans Mono"
       x="162.71783"
       y="498.29968"
       id="text4161"><tspan
         sodipodi:role="line"
         id="tspan4163"
         x="162.71783"
         y="498.29968">module Main where</tspan><tspan
         sodipodi:role="line"
         x="162.71783"
         y="518.29968"
         id="tspan4165"></tspan><tspan
         sodipodi:role="line"
         x="162.71783"
         y="538.29968"
         id="tspan4167">import Control.Concurrent</tspan><tspan
         sodipodi:role="line"
         x="162.71783"
         y="558.29968"
         id="tspan4169">import Control.Exception</tspan><tspan
         sodipodi:role="line"
         x="162.71783"
         y="578.29968"
         id="tspan4171">import Control.Monad</tspan><tspan
         sodipodi:role="line"
         x="162.71783"
         y="598.29968"
         id="tspan4173">import MonadLib</tspan><tspan
         sodipodi:role="line"
         x="162.71783"
         y="618.29968"
         id="tspan4175">import Network</tspan><tspan
         sodipodi:role="line"
         x="162.71783"
         y="638.29968"
         id="tspan4177">import System.IO</tspan><tspan
         sodipodi:role="line"
         x="162.71783"
         y="658.29968"
         id="tspan4179"></tspan><tspan
         sodipodi:role="line"
         x="162.71783"
         y="678.29968"
         id="tspan4181"></tspan><tspan
         sodipodi:role="line"
         x="162.71783"
         y="698.29968"
         id="tspan4183">handleClient :: Handle -&gt; IO ()</tspan><tspan
         sodipodi:role="line"
         x="162.71783"
         y="718.29968"
         id="tspan4185">handleClient h = do</tspan><tspan
         sodipodi:role="line"
         x="162.71783"
         y="738.29968"
         id="tspan4187">  hSetBuffering h NoBuffering</tspan><tspan
         sodipodi:role="line"
         x="162.71783"
         y="758.29968"
         id="tspan4189">  hGetContents h &gt;&gt;= hPutStr h</tspan><tspan
         sodipodi:role="line"
         x="162.71783"
         y="778.29968"
         id="tspan4191"></tspan><tspan
         sodipodi:role="line"
         x="162.71783"
         y="798.29968"
         id="tspan4193"></tspan><tspan
         sodipodi:role="line"
         x="162.71783"
         y="818.29968"
         id="tspan4195">logMessage :: String -&gt; IO ()</tspan><tspan
         sodipodi:role="line"
         x="162.71783"
         y="838.29968"
         id="tspan4197">logMessage = hPutStrLn stderr</tspan><tspan
         sodipodi:role="line"
         x="162.71783"
         y="858.29968"
         id="tspan4199"></tspan><tspan
         sodipodi:role="line"
         x="162.71783"
         y="878.29968"
         id="tspan4201"></tspan><tspan
         sodipodi:role="line"
         x="162.71783"
         y="898.29968"
         id="tspan4203">main :: IO ()</tspan><tspan
         sodipodi:role="line"
         x="162.71783"
         y="918.29968"
         id="tspan4205">main = do</tspan><tspan
         sodipodi:role="line"
         x="162.71783"
         y="938.29968"
         id="tspan4207">  sock &lt;- listenOn (PortNumber 40000)</tspan><tspan
         sodipodi:role="line"
         x="162.71783"
         y="958.29968"
         id="tspan4209">  forever $ do</tspan><tspan
         sodipodi:role="line"
         x="162.71783"
         y="978.29968"
         id="tspan4211">    (h, host, port) &lt;- accept sock</tspan><tspan
         sodipodi:role="line"
         x="162.71783"
         y="998.29968"
         id="tspan4213">    logMessage (&quot;Connection from: &quot; ++ host)</tspan><tspan
         sodipodi:role="line"
         x="162.71783"
         y="1018.2997"
         id="tspan4215">    forkIO $ handleClient h `finally` hClose h</tspan><tspan
         sodipodi:role="line"
         x="162.71783"
         y="1038.2997"
         id="tspan4217" /></text>
    <text
       xml:space="preserve"
       style="font-size:62.16495895px;font-style:normal;font-variant:normal;font-weight:bold;font-stretch:normal;fill:#522d71;fill-opacity:1;stroke:none;font-family:Kinnari;-inkscape-font-specification:Kinnari Medium"
       x="433.75378"
       y="235.71661"
       id="text3963"><tspan
         sodipodi:role="line"
         id="tspan3965"
         x="433.75378"
         y="235.71661"
         style="font-size:62.16495895px;font-style:normal;-inkscape-font-specification:Andale Mono"><tspan
           style="fill:#64378a;fill-opacity:1"
           id="tspan4298">h</tspan><tspan
           style="font-size:62.16495895px;fill:#64378a;fill-opacity:1"
           id="tspan4008"><tspan
             style="fill:#723f9d;fill-opacity:1"
             id="tspan4300">p</tspan><tspan
             style="fill:#7442d9;fill-opacity:1"
             id="tspan4304"><tspan
               style="fill:#6f22a7;fill-opacity:1"
               id="tspan4346">a</tspan><tspan
               style="fill:#5826bf;fill-opacity:1"
               id="tspan4376">s</tspan></tspan><tspan
             style="fill:#3a378a;fill-opacity:1"
             id="tspan4330"><tspan
   style="fill:#5840a0;fill-opacity:1"
   id="tspan4350">t</tspan>e</tspan></tspan></tspan><tspan
         sodipodi:role="line"
         x="433.75378"
         y="313.42282"
         id="tspan4000" /></text>
  </g>
</svg>
